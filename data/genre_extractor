import csv


genres_to_include = ["Horror", "Thriller"]


with open('data/movie_dataset.csv', 'r') as infile, open('output.csv', 'w', newline='') as outfile:
    reader = csv.DictReader(infile)
    writer = csv.DictWriter(outfile, fieldnames=reader.fieldnames)
    writer.writeheader()
    
    for row in reader:
        current_genres = row['genres'].split(' ')
        if any(genre in genres_to_include for genre in current_genres):
            writer.writerow(row)